<html>

<head>
    <title>Roue Orange Cote d'Ivoire</title>
    <!-- <script type="text/javascript" src="./Winwheel.js"></script> -->
    <script src="http://dougtesting.net/elements/javascript/Winwheel.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script> -->
    <!-- <script src="./sweetalet.js"></script> -->
    <script src="http://154.68.9.63/cote_pages/uploads/1/js/sweetalet.js"></script>

    <!-- MAKE COOCKIES -->
    <script>
        function setCookie(name,value,days) {
        var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days*24*60*60*1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "")  + expires + "; path=/";
            // document.cookie = 'cookie1=test; expires=Sun, 1 Jan 2023 00:00:00 UTC; path=/'
        }
        function getCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }
        function eraseCookie(name) {   
            document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        }

        if(getCookie("done") == true || getCookie("done") == 'true' ){
            
            alert('OOps... Vous avez dejà joué!!!')

            window.location.replace('https://communaute.orange.ci/');
        }
    </script>


    <style>
        body {
            background: url('https://e7.pngegg.com/pngimages/618/729/png-clipart-party-cracker-congratulation-holidays-text.png');
        }

        body {
            font-family: arial;
        }

        /* Sets the background image for the wheel */
        td.the_wheel {
            background-image: url(http://154.68.9.63/cote_pages/uploads/1/img/wheel_back.png?rand=1634315570661);
            background-position: center;
            background-repeat: none;
        }

        /* Do some css reset on selected elements */
        h1,
        p {
            margin: 0;
        }

        div.power_controls {
            margin-right: 70px;
        }

        div.html5_logo {
            margin-left: 70px;
        }

        /* Styles for the power selection controls */
        table.power {
            background-color: #cccccc;
            cursor: pointer;
            border: 1px solid #333333;
        }

        table.power th {
            background-color: white;
            cursor: default;
        }

        td.pw1 {
            background-color: #6fe8f0;
        }

        td.pw2 {
            background-color: #86ef6f;
        }

        td.pw3 {
            background-color: #ef6f6f;
        }

        /* Style applied to the spin button once a power has been selected */
        .clickable {
            cursor: pointer;
        }

        /* Other misc styles */
        .margin_bottom {
            margin-bottom: 5px;
        }
    </style>
</head>

<body>
    <div align="center">
        <h1>Roue de fortune Orange Côte d'Ivoire</h1>
        <br />
        <!-- <img src="https://www.orange.ci/particuliers/resources/img/Top_up_Mobile_19371.svg" alt=""> -->
        <table cellpadding="0" cellspacing="0" border="0" id="wheel" class="">
            <tr>
                <td width="438" height="582" class="the_wheel" align="center" valign="center">
                    <canvas id="canvas" width="434" height="434" onClick="startSpin();">
                        <p style="{color: white}" align="center">Sorry, your browser doesn't support canvas. Please try
                            another.</p>
                    </canvas>
                </td>
            </tr>
        </table>

        <div id="user_form" style="display:none">
            <div class="row p-4 bg-white align-middle">
                <div class="row">
                    <h2 class="content-head is-center">FELICITATIONS !</h2>
                    <p>
                        Formulaire de prise de contact pour les prix de la communauté
                    </p>
                </div>
                <div class="row">
                    <form class="gform pure-form pure-form-stacked" method="POST" data-email="toure5013@gmail.com"
                        action="https://script.google.com/macros/s/AKfycbz7alLh0EAm8cj8iPwyC1ApwCvBUy2VgYJoGq88LI2oCgflVvaaryplykiC5u_nOC9-KQ/exec">
                        <!-- change the form action to your script url -->

                        <div class="form-elements mt-4">
                            <div class="form-group mb-3">
                                <label for="firstname">Nom: </label>
                                <input type="text" id="firstname" class="form-control" name="firstname"
                                    placeholder="Votre nom" value="test" />
                            </div>
                            <div class="form-group mb-3">
                                <label for="lastname">Prenom: </label>
                                <input type="text" id="lastname" class="form-control" name="lastname"
                                    placeholder="Votre prenom" value="test2" />
                            </div>

                            <div class="form-group mb-3">
                                <label for="email"><em>Votre</em> Email:</label>
                                <input id="email" name="email" class="form-control" type="tel" value="test@test.com"
                                    required placeholder="test@test.com" />
                            </div>

                            <div class="form-group mb-3">
                                <label for="email"><em>Votre</em> Numéro de téléphone:</label>
                                <input id="phone" name="phone" class="form-control" type="tel" value="070707070707"
                                    required placeholder="070707070707" />
                            </div>

                            <div class="form-group mb-3" style="display: none;">
                                <input id="price" name="price" class="form-control" type="hidden" value="prix 1"
                                    required>
                            </div>

                            <div class="form-group mb-3" style="display: none;">
                                <label for="other">Email: </label>
                                <textarea id="other" name="other" class="form-control" rows="10" value="suplement"
                                    placeholder="your.name@email.com"> D'autres information</textarea>
                            </div>

                            <div class="form-group mb-3 honeypot-field" style="display:none">
                                <label for="honeypot">To help avoid spam, utilize a Honeypot technique with a hidden
                                    text field;
                                    must be
                                    empty to submit the form! Otherwise, we assume the user is a spam bot.</label>
                                <input id="honeypot" type="text" name="honeypot" value="" readonly />
                            </div>

                            <div class="text-right row">
                                <div class="col-6">
                                    <button class="btn btn-success "><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" fill="currentColor" class="bi bi-card-checklist"
                                            viewBox="0 0 16 16">
                                            <path
                                                d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
                                            <path
                                                d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0zM7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z" />
                                        </svg>&nbsp;Envoyer</button>
                                </div>
                            </div>
                        </div>

                        <!-- Customise the Thankyou Message People See when they submit the form: -->
                        <div class="thankyou_message alert alert-info" style="display:none;">
                            <h2><em>Merci</em> Nous vous revenons sous peu! </h2>
                            <br>
                            <a href="https://communaute.orange.ci/" class="btn btn-warning">Revenir sur le portail</a>
                        </div>

                    </form>
                </div>

            </div>

        </div>


    </div>
    <script>


        // document.getElementById('spin_button').src = "spin_on.png";
        // Create new wheel object specifying the parameters at creation time.
        let theWheel = new Winwheel({
            'numSegments': 14,
            'imageOverlay': true,
            'lineWidth': 4,          // Overlay uses wheel line width and stroke style so can set these
            'outerRadius': 212,   // Set outer radius so wheel fits inside the background.
            'textFontSize': 20,    // Set font size as desired.
            'segments':        // Define segments including colour and text.
                [
                    { 'fillStyle': '#4bb4e6', 'text': 'stylo' },
                    { 'fillStyle': '#ffd200', 'text': 'tee-shirt' },
                    { 'fillStyle': '#50be87', 'text': 'sac bandou' },
                    { 'fillStyle': '#a885d8', 'text': 'sac a dos' },
                    { 'fillStyle': '#eae56f', 'text': 'power bank' },
                    { 'fillStyle': '#ff7900', 'text': 'domino' },

                    //----- SECOND LINE --------
                    { 'fillStyle': '#4bb4e6', 'text': 'casque' },
                    { 'fillStyle': '#ffd200', 'text': 'carte 5k' },
                    { 'fillStyle': '#50be87', 'text': 'carte 1k' },
                    { 'fillStyle': '#ff7900', 'text': 'carte 2,5k' },
                    { 'fillStyle': '#ff7900', 'text': 'telephone' },
                    { 'fillStyle': '#a885d8', 'text': 'montre connectée' },
                    { 'fillStyle': '#a885d8', 'text': 'carte 25k' },
                    { 'fillStyle': '#cd3c14', 'text': 'carte 10k' },
                    { 'fillStyle': '#32c832', 'text': 'bon d\'achat' },

                ],
            'animation':           // Specify the animation to use.
            {
                'type': 'spinToStop',
                'duration': 15,     // Duration in seconds.
                'spins': 8,     // Number of complete spins.
                'callbackFinished': alertPrize,
                'callbackSound': playSound,   // Function to call when the tick sound is to be triggered.
                'soundTrigger': 'pin'
            },
            'pins':
            {
                'number': 16   // Number of pins. They space evenly around the wheel.
            }
        });

        // -----------------------------------------------------------------
        // This function is called when the segment under the prize pointer changes
        // we can play a small tick sound here like you would expect on real prizewheels.
        // -----------------------------------------------------------------
        let audio = new Audio('tick.mp3');  // Create audio object and load tick.mp3 file.

        function playSound() {
            // Stop and rewind the sound if it already happens to be playing.
            audio.pause();
            audio.currentTime = 0;

            // Play the sound.
            audio.play();
        }

        // Vars used by the code in this page to do power controls.
        let wheelPower = 0;
        let wheelSpinning = false;

        // -------------------------------------------------------
        // Click handler for spin button.
        // -------------------------------------------------------
        function startSpin() {
            wheelPower = 2;
            resetWheel();
            // Ensure that spinning can't be clicked again while already running.
            if (wheelSpinning == false) {
                // Based on the power level selected adjust the number of spins for the wheel, the more times is has
                // to rotate with the duration of the animation the quicker the wheel spins.
                if (wheelPower == 1) {
                    theWheel.animation.spins = 3;
                } else if (wheelPower == 2) {
                    theWheel.animation.spins = 8;
                } else if (wheelPower == 3) {
                    theWheel.animation.spins = 15;
                }

                // Disable the spin button so can't click again while wheel is spinning.
                // document.getElementById('spin_button').src = "spin_off.png";
                // document.getElementById('spin_button').className = "";

                // Begin the spin animation by calling startAnimation on the wheel object.
                theWheel.startAnimation();

                // Set to true so that power can't be changed and spin button re-enabled during
                // the current animation. The user will have to reset before spinning again.
                wheelSpinning = true;
            }
        }

        // -------------------------------------------------------
        // Function for reset button.
        // -------------------------------------------------------
        function resetWheel() {
            theWheel.stopAnimation(false);  // Stop the animation, false as param so does not call callback function.
            theWheel.rotationAngle = 0;     // Re-set the wheel angle to 0 degrees.
            theWheel.draw();                // Call draw to render changes to the wheel.

            // document.getElementById('pw1').className = "";  // Remove all colours from the power level indicators.
            // document.getElementById('pw2').className = "";
            // document.getElementById('pw3').className = "";

            wheelSpinning = false;          // Reset to false to power buttons and spin can be clicked again.
            // document.getElementById('spin_button').src = "spin_on.png";
        }


        // -------------------------------------------------------
        // Called when the spin animation has finished by the callback feature of the wheel because I specified callback in the parameters
        // note the indicated segment is passed in as a parmeter as 99% of the time you will want to know this to inform the user of their prize.
        // -------------------------------------------------------
        function alertPrize(indicatedSegment) {
            var audio = new Audio('applause2.mp3');
            audio.play();
            // console.log(indicatedSegment.text);
            // Do basic alert of the segment text. You would probably want to do something more interesting with this information.
            // alert("You have won " + indicatedSegment.text);
            // window.location.replace('/');
            var wheel = document.getElementById('wheel');
            var user_form = document.getElementById('user_form');

            //show && hide elements 
            user_form.style.display = "block";
            wheel.style.display = "none";


            document.getElementById("price").value = indicatedSegment.text;

            Swal.fire({
                html: '<img src="./images/' + indicatedSegment.text + '.png" alt="" > <br>Remplissez le formulaire, nous vous contacterons.',
                title: 'Félicitation, vous avez gagné  le cadeau suivant: ' + indicatedSegment.text,
                width: 600,
                padding: '3em',
                background: '#fff url(./images/trees.png)',
                backdrop: `
                    rgba(0,0,123,0.4)
                    url("./images/nyan-cat.gif")
                    left top
                    no-repeat
                `
            })

        }
    </script>

    <!-- Submit the Form to Google Using "AJAX" -->
    <script data-cfasync="false">
        (function () {
            // get all data in form and return object
            function getFormData(form) {
                var elements = form.elements;
                var honeypot;

                var fields = Object.keys(elements).filter(function (k) {
                    if (elements[k].name === "honeypot") {
                        honeypot = elements[k].value;
                        return false;
                    }
                    return true;
                }).map(function (k) {
                    if (elements[k].name !== undefined) {
                        return elements[k].name;
                        // special case for Edge's html collection
                    } else if (elements[k].length > 0) {
                        return elements[k].item(0).name;
                    }
                }).filter(function (item, pos, self) {
                    return self.indexOf(item) == pos && item;
                });

                var formData = {};
                fields.forEach(function (name) {
                    var element = elements[name];

                    // singular form elements just have one value
                    formData[name] = element.value;

                    // when our element has multiple items, get their values
                    if (element.length) {
                        var data = [];
                        for (var i = 0; i < element.length; i++) {
                            var item = element.item(i);
                            if (item.checked || item.selected) {
                                data.push(item.value);
                            }
                        }
                        formData[name] = data.join(', ');
                    }
                });

                // add form-specific values into the data
                // formData.formDataNameOrder = JSON.stringify(fields);
                formData.formGoogleSheetName = form.dataset.sheet || "roue_communautaire"; // default sheet name
                formData.formGoogleSendEmail
                    = form.dataset.email || ""; // no email by default

                return { data: formData, honeypot: honeypot };
            }

            function handleFormSubmit(event) {  // handles form submit without any jquery
                event.preventDefault();           // we are submitting via xhr below
                var form = event.target;
                var formData = getFormData(form);
                var data = formData.data;

                // If a honeypot field is filled, assume it was done so by a spam bot.
                if (formData.honeypot) {
                    return false;
                }

                disableAllButtons(form);
                var url = form.action;
                var xhr = new XMLHttpRequest();
                xhr.open('POST', url);
                // xhr.withCredentials = true;
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        form.reset();
                        var formElements = form.querySelector(".form-elements")
                        if (formElements) {
                            formElements.style.display = "none"; // hide form
                        }
                        var thankYouMessage = form.querySelector(".thankyou_message");
                        if (thankYouMessage) {
                            thankYouMessage.style.display = "block";
                        }
                        //save a coockies in user computer to nitify that he has already play
                        setCookie("done","true", 30);
                        // console.log(getCookie("done")); 
                    }
                };
                // url encode form data for sending as post data
                var encoded = Object.keys(data).map(function (k) {
                    return encodeURIComponent(k) + "=" + encodeURIComponent(data[k]);
                }).join('&');
                xhr.send(encoded);
            }

            function loaded() {
                // bind to the submit event of our form
                var forms = document.querySelectorAll("form.gform");
                for (var i = 0; i < forms.length; i++) {
                    forms[i].addEventListener("submit", handleFormSubmit, false);
                }
            };
            document.addEventListener("DOMContentLoaded", loaded, false);

            function disableAllButtons(form) {
                var buttons = form.querySelectorAll("button");
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].disabled = true;
                }
            }
        })();
    </script>
    <!-- END -->


</body>

</html>